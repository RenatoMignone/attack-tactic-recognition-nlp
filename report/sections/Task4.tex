\section{Inference}\label{sec:task4}
We now focus on the inference dataset (from \emph{cyberlab.csv}). First, we applied the same preprocessing adopted previously, truncating words longer than 30 characters. Then, we used the best model identified in \cref{sec:task3} (i.e., UniXcoder-base, $lr=10^{-5}$, 15 epochs) to predict MITRE tags for all the inference sessions, assigning to each bash word the tag associated with the first corresponding token.

\subsection{Predicted tags analysis}
\paragraph{Tags frequency for \texttt{cat}, \texttt{grep}, \texttt{echo}, and \texttt{rm}} \Cref{tab:task4_tags_frequency} summarizes the tag frequencies for the required commands (\texttt{cat}, \texttt{grep}, \texttt{echo}, and \texttt{rm}), computed as the number of times that tag was assigned to a command, divided by the total number of occurrences of that command. Only \texttt{grep} is uniquely associated with a single tag (\emph{Discovery}), while \texttt{cat} is assigned to two different tags: \emph{Discovery} (\SI{90.9}{\percent} of times) and \emph{Execution} (\SI{9.1}{\percent}). \texttt{echo} is mainly associated with three different tags: \emph{Persistence}, \emph{Discovery} and \emph{Execution}. Finally, \texttt{rm} is assigned to four tags (\emph{Discovery}, \emph{Execution}, \emph{Defense Evasion} and \emph{Persistence}). Considering these commands, some tags are almost never associated with any session; this is the case of \emph{Impact}, \emph{Not Malicious Yet}, and \emph{Other}.

\begin{table}
\small
\centering
\caption{Tags frequency for \texttt{cat}, \texttt{grep}, \texttt{echo}, and \texttt{rm}.}
\label{tab:task4_tags_frequency}
\begin{tabular}{lcccc}
\toprule
{Tag} & {\texttt{cat}} & {\texttt{grep}} & {\texttt{echo}} & {\texttt{rm}} \\
\midrule
Defense Evasion 	& 0.000 	& 0.000 	& 0.000 	& 0.049  \\
Discovery 			& 0.909 	& 1.000 	& 0.334 	& 0.738	\\
Execution 			& 0.091 	& 0.000 	& 0.234 	& 0.196 \\
Impact 				& 0.000 	& 0.000 	& 0.000 	& 0.000 	\\
Not Malicious Yet 	& 0.000 	& 0.000 	& 0.001 	& 0.000 \\
Other 				& 0.000 	& 0.000 	& 0.004 	& 0.000 \\
Persistence 		& 0.000 	& 0.000 	& 0.427 	& 0.017 \\
\bottomrule
\end{tabular}
\end{table}

\paragraph{Session examples} We will now qualitatively analyze one example of a session for each unique tuple (command, predicted tag), focusing only on those appeared more than \SI{1}{\percent} of times.

\textbf{(\texttt{cat}, Discovery):} \texttt{[\dots]; cat /proc/mounts; [\dots]}. This command reads and displays the contents of the file \texttt{/proc/mounts}, listing information about storage devices, network mounts and virtual file systems. Attackers can use it to analyze the target's file system structure before attempting further exploitation or lateral movement. Since it is purely information gathering, the tag \emph{Discovery} is appropriate.

\textbf{(\texttt{cat}, Execution):} \texttt{[\dots]; echo ``1'' > /var/tmp/.sysc436621 ; cat /var/tmp/.sysc436621 ; [\dots]}\footnote{The file path has been shortened for visualization purposes. The original one is \texttt{/var/tmp/.systemcache436621}.}. In this case, \texttt{cat} reads a hidden file from the temporary directory, created by a previous \texttt{echo}. Even if the \texttt{cat} command itself does not execute any malicious code (it looks like a validation step), it has likely been marked as \emph{Execution} because it precedes the subsequent code execution in the attack chain. Based on that, a more appropriate tag for this instance may have been \emph{Not Malicious Yet}.

\textbf{(\texttt{grep}, Discovery):} \texttt{cat /proc/cpuinfo | grep name | wc -l ; [\dots]}. The \texttt{grep} command filters the \texttt{cat} output to find lines containing the word ``name'', enabling the attacker to profile the target system's CPU specifications. The \emph{Discovery} tag looks accurate, since attackers are gathering hardware details before attempting exploitation or lateral movement.

\textbf{(\texttt{echo}, Persistence):} \texttt{[\dots]; echo ``root:XP3IUReH9hhH'' | chpasswd | bash ; [\dots]}. The \texttt{echo} command outputs the string \texttt{root:XP3IUReH9hhH}, which is piped to \texttt{chpasswd}, that updates user passwords from standard input. By changing the \texttt{root} user's password to a known value, the attacker gains persistent administrative access to the compromised system. As this session looks very similar to the one from the training set already analyzed in \cref{sec:task1_echo_analysis}, the \emph{Persistence} tag is appropriate.

\textbf{(\texttt{echo}, Discovery):} \texttt{[\dots]; echo ``root 1ntr4n3t'' > /tmp/up.txt ; [\dots]}. It looks like the \texttt{echo} command is used to save credential credentials to the \texttt{/tmp/up.txt} file, potentially for future access. Hence, a \emph{Persistence} tag may be more appropriate.

\textbf{(\texttt{echo}, Execution):} \texttt{[\dots]; echo
``base64\_payload'' | base64 -{}-{}decode | bash ;}. The \texttt{echo} command outputs a base64 payload, that is then decoded and executed. Hence, the command executes arbitrary code, probably a malware binary. As this session looks very similar to the one from the training set already analyzed in \cref{sec:task1_echo_analysis}, the \emph{Execution} tag looks correct.

\textbf{(\texttt{rm}, Discovery):} \texttt{[\dots]; echo ``321'' > /var/tmp/.v03522123; rm -rf /var/tmp/.v03522123; [\dots]}\footnote{The file path has been shortened for visualization purposes. The original one is \texttt{/var/tmp/.var03522123}.}. This command sequence writes \texttt{321} into a file, which is then immediately deleted. The model has probably marked the \texttt{rm} command as \emph{Discovery} because it is surrounded by file operations that can be associated with a discovery phase, and could be motivated as a permission check. This looks reasonable, given that this sequence does not seem relevant by itself from an attacker's point of view.

\textbf{(\texttt{rm}, Execution):} \texttt{[\dots]; rm -rf /var/tmp/dota* ; [\dots]}. This command deletes all the files and folders whose names begin with \texttt{dota} in the \texttt{/var/tmp} directory. This is an active operation, removing files that may contain traces of previous actions. Hence, in that case the \emph{Defense Evasion} tag would have been more appropriated.

\textbf{(\texttt{rm}, Defense Evasion):} \texttt{[\dots]; cp /bin/echo .s ; [\dots]; rm .s ; exit}. This command sequence copies the \texttt{echo} binary in \texttt{.s}, that is eventually deleted as last step. This operation is clearly \emph{Defense Evasion} because it is the final cleanup step that removes forensic evidence of the attack.

\textbf{(\texttt{rm}, Persistence):} \texttt{[\dots]; echo ``admin Passwd4'' > /tmp/up.txt ; rm -rf /var/tmp/dota*}. This command deletes all the files and folders whose names begin with \texttt{dota} in the \texttt{/var/tmp} directory. Hence, it looks like a \emph{Defense Evasion} technique, removing files that may contain traces of previous actions. However, the model probably considers it as \emph{Persistence} due to the previous steps, such as the \texttt{echo} command that saves the credentials to the \texttt{/tmp/up.txt} file, making them persistent across restarts.


\subsection{Fingerprint Analysis}
Subsequently, we focused on the fingerprints extracted from the predictions for the inference dataset. After having identified the unique fingerprints, we sorted them by ``date of birth'' and we assigned to each an incremental ID. Then, we counted the number of sessions described by a specific fingerprint for each date.

\Cref{fig:fingerprintTimeline} shows fingerprints IDs appearance over time: the y-axis lists fingerprint IDs (the lower the value, the earlier the fingerprint appeared for the first time), while the x-axis represents the full data-collection period. Each point indicates that at least one session associated with that fingerprint occurred on that date. The size and color of each point reflect how many sessions for that fingerprint were recorded that day: larger and redder points correspond to more sessions.

\begin{figure}
	\centering
	\includegraphics[width=0.9\linewidth]{img/Task4/fingerprint_timeline_small_circles.png}
	\caption{Fingerprint IDs over time. The y-axis lists fingerprint IDs (the lower the value, the earlier the fingerprint appeared for the first time), while the x-axis represents the full data-collection period. Each point indicates that at least one session associated with that fingerprint occurred on that date. The size and color of each point reflect how many sessions for that fingerprint were recorded that day: larger and redder points correspond to more sessions.}
	\label{fig:fingerprintTimeline}
\end{figure}

\paragraph{Fingerprint patterns}  The plot reveals clear temporal and structural patterns in the inference dataset. During the collection period (lasted four months), 15516 unique fingerprints were observed: horizontal bands indicate fingerprints that reappear over multiple days or weeks, while vertical columns refer to daily batches of observed fingerprints. The large number of unique fingerprints reflects the combinatorial nature of sequence-level tactic representations, where small variations in command structure lead to distinct fingerprints. In the first one month and a half, a relatively small number of unique fingerprints appeared ($\approx1150$), while this number increased significantly, reaching $7000$, by the \nth{1} of December. In the final month of collection, more than $7000$ new fingerprints appeared, and the vertical columns became denser (excluding a day in mid-December, in which no session was received). This likely indicates that attackers moved to a more active phase, both in terms of quantity and diversity of sessions. However, in the last week of collection, many fingerprints disappeared or became rare, as shown by the presence of sparse points in the plot. Still, the last appeared (those with ID $\approx15000$) continued arriving.

\paragraph{Most present fingerprints} A subset of fingerprints, primarily with low IDs ($<500$), appears persistently throughout the entire observation period. In particular, the fingerprints present on most days are those with IDs 0, 17, 19 and 21 (with 99 days of presence out of 122). However, some of them stopped appearing or became rarer in the last period of collection (after the \nth{10} of December).

\paragraph{Fingerprints with many sessions} Some fingerprints have numerous associated sessions: examples are fingerprint 21 (26036 sessions), 48 (17639), 25 (7169), 42 (4479) and 8858 (4342). However, these numbers do not always translate in big red circles on the plot, since many sessions span across the whole collection period: the medium-sized yellow/orange clusters at the bottom mostly correspond to ``regular'' fingerprints, indicating attacks carried out constantly during the entire collection period. Hence, they cannot be considered as sporadic attack campaigns.

\paragraph{Attack campaigns} Some fingerprints exhibit burst-like behavior, characterized by sudden appearance and high numbers of associated sessions over short time intervals. Most notably, a dominant fingerprint (8858) emerging in mid-December 2019 (\nth{8}\,--\,\nth{10}) reaches the highest session count per day ($>1000$) in the dataset, strongly indicating a coordinated attack campaign. This fingerprint describes a complex session of 153 Bash words that follows a classic attack lifecycle: it begins with an initial \emph{Discovery} phase (9 words), moves briefly into \emph{Persistence} (8 words), returns to an extensive \emph{Discovery} phase (103 words), and concludes with an \emph{Execution} phase (12 words) that culminates in a final \emph{Persistence} setup (21 words). This structural progression probably indicates a coordinated campaign where the attacker moved from system exploration to active exploitation and backdoor installation. Finally, the late-December period shows a dense concentration of high-ID fingerprints with moderate to high activity, consistent with another attack campaign.